{% extends 'core/base.html' %}
{% load static %}

{% block title %}Holiday Calendar | Petabytz{% endblock %}

{% block extra_css %}
<style>
    :root {
        --keka-primary: #5b47fb;
        --keka-success: #00c48c;
        --keka-danger: #ff647c;
        --keka-warning: #ffa26b;
        --keka-bg: #f8f9fd;
        --keka-card: #ffffff;
        --keka-border: #e8ecf4;
        --keka-text-primary: #1e2139;
        --keka-text-secondary: #6c7293;
    }

    body {
        background: var(--keka-bg);
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    .page-header {
        background: linear-gradient(135deg, var(--keka-primary) 0%, #7c6bff 100%);
        color: white;
        padding: 32px;
        margin-bottom: 24px;
        border-radius: 0 0 24px 24px;
    }

    .stats-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }

    .stat-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        border-left: 4px solid var(--keka-primary);
    }

    .stat-card.success {
        border-left-color: var(--keka-success);
    }

    .stat-card.warning {
        border-left-color: var(--keka-warning);
    }

    .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: var(--keka-text-primary);
        margin-bottom: 4px;
    }

    .stat-label {
        font-size: 13px;
        color: var(--keka-text-secondary);
    }

    .filter-bar {
        background: white;
        padding: 16px 20px;
        border-radius: 12px;
        margin-bottom: 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .year-selector {
        padding: 8px 16px;
        border: 1.5px solid var(--keka-border);
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        color: var(--keka-text-primary);
        background: white;
    }

    .upcoming-section {
        background: white;
        padding: 24px;
        border-radius: 12px;
        margin-bottom: 24px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .section-title {
        font-size: 18px;
        font-weight: 700;
        color: var(--keka-text-primary);
        margin-bottom: 16px;
    }

    .upcoming-holiday {
        display: flex;
        align-items: center;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 8px;
        background: var(--keka-bg);
    }

    .holiday-date-box {
        width: 60px;
        height: 60px;
        background: var(--keka-primary);
        color: white;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-right: 16px;
    }

    .date-day {
        font-size: 24px;
        font-weight: 700;
        line-height: 1;
    }

    .date-month {
        font-size: 11px;
        text-transform: uppercase;
        opacity: 0.9;
    }

    .holiday-info {
        flex: 1;
    }

    .holiday-name {
        font-size: 15px;
        font-weight: 600;
        color: var(--keka-text-primary);
        margin-bottom: 2px;
    }

    .holiday-meta {
        font-size: 12px;
        color: var(--keka-text-secondary);
    }

    .month-section {
        background: white;
        padding: 24px;
        border-radius: 12px;
        margin-bottom: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .month-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--keka-text-primary);
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--keka-border);
    }

    .holiday-card {
        display: flex;
        align-items: center;
        padding: 16px;
        border-radius: 10px;
        margin-bottom: 12px;
        border: 1.5px solid var(--keka-border);
        transition: all 0.2s;
    }

    .holiday-card:hover {
        border-color: var(--keka-primary);
        box-shadow: 0 4px 12px rgba(91, 71, 251, 0.1);
        transform: translateY(-2px);
    }

    .location-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        margin-left: 8px;
        background: #f1f5f9;
        color: #64748b;
    }

    .location-india {
        background: #fff4e6;
        color: #ff9f43;
    }

    .location-us {
        background: #e0f2fe;
        color: #0284c7;
    }

    .location-dhaka {
        background: #dcfce7;
        color: #16a34a;
    }

    .location-global {
        background: #f3e8ff;
        color: #9333ea;
    }

    .type-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        margin-left: 8px;
        background: #f1f5f9;
        color: #64748b;
    }

    .type-mandatory {
        background: #d1fae5;
        color: #065f46;
    }

    .type-optional {
        background: #fef3c7;
        color: #92400e;
    }

    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: var(--keka-text-secondary);
    }

    .empty-icon {
        font-size: 64px;
        margin-bottom: 16px;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <div class="container-fluid px-4">
        <h1 style="font-size: 28px; font-weight: 700; margin: 0 0 8px 0;">
            üóìÔ∏è Holiday Calendar {{ year_filter }}
        </h1>
        <p style="font-size: 14px; opacity: 0.9; margin: 0;">
            Showing holidays for <strong>{{ employee_location }}</strong> location
        </p>
    </div>
</div>

<div class="container-fluid px-4 pb-4">
    <!-- Statistics -->
    <div class="stats-row">
        <div class="stat-card">
            <div class="stat-value">{{ total_holidays }}</div>
            <div class="stat-label">Total Holidays</div>
        </div>
        <div class="stat-card success">
            <div class="stat-value">{{ mandatory_count }}</div>
            <div class="stat-label">Mandatory Holidays</div>
        </div>
        <div class="stat-card warning">
            <div class="stat-value">{{ optional_count }}</div>
            <div class="stat-label">Optional Holidays</div>
        </div>
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar">
        <h3 style="font-size: 16px; font-weight: 600; color: var(--keka-text-primary); margin: 0;">
            All Holidays
        </h3>
        <form method="get">
            <select name="year" class="year-selector" onchange="this.form.submit()">
                {% for year in years %}
                <option value="{{ year }}" {% if year == year_filter %}selected{% endif %}>{{ year }}</option>
                {% endfor %}
                {% if not years %}
                <option value="{{ year_filter }}">{{ year_filter }}</option>
                {% endif %}
            </select>
        </form>
    </div>

    <!-- Upcoming Holidays -->
    {% if upcoming_holidays %}
    <div class="upcoming-section">
        <h2 class="section-title">üîî Upcoming Holidays</h2>
        {% for holiday in upcoming_holidays %}
        <div class="upcoming-holiday">
            <div class="holiday-date-box">
                <div class="date-day">{{ holiday.date|date:"d" }}</div>
                <div class="date-month">{{ holiday.date|date:"M" }}</div>
            </div>
            <div class="holiday-info">
                <div class="holiday-name">{{ holiday.name }}</div>
                <div class="holiday-meta">
                    {{ holiday.date|date:"l, F d, Y" }}
                    <span class="location-badge location-{{ holiday.location.name|lower }}">
                        {{ holiday.location.name }}
                    </span>
                    <span class="type-badge type-{{ holiday.holiday_type|lower }}">
                        {{ holiday.get_holiday_type_display }}
                    </span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Holidays by Month -->
    {% if holidays_by_month %}
    {% for month, month_holidays in holidays_by_month.items %}
    <div class="month-section">
        <h3 class="month-title">{{ month }}</h3>
        {% for holiday in month_holidays %}
        <div class="holiday-card">
            <div class="holiday-date-box" style="margin-right: 20px;">
                <div class="date-day">{{ holiday.date|date:"d" }}</div>
                <div class="date-month">{{ holiday.date|date:"M" }}</div>
            </div>
            <div class="holiday-info">
                <div class="holiday-name">
                    {{ holiday.name }}
                    <span class="location-badge location-{{ holiday.location.name|lower }}">
                        {{ holiday.location.name }}
                    </span>
                    <span class="type-badge type-{{ holiday.holiday_type|lower }}">
                        {{ holiday.get_holiday_type_display }}
                    </span>
                </div>
                <div class="holiday-meta">
                    {{ holiday.date|date:"l" }}
                    {% if holiday.description %}
                    ‚Ä¢ {{ holiday.description }}
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endfor %}
    {% else %}
    <div class="month-section">
        <div class="empty-state">
            <div class="empty-icon">üìÖ</div>
            <p style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">No Holidays Found</p>
            <p style="font-size: 14px;">No holidays have been configured for {{ year_filter }} yet.</p>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}